var zombie = new require('zombie')
var zombiecss = require('../zombiecss.js') //optional zombie param

var url = 'file:///Users/prestl02/Projects/zombiecss/sample.html'

var defaultOptions = {
    resemblejs: {
        errorColor: {
            red: 255,
            green: 0,
            blue: 255
        },
        errorType: 'movement',
        transparency: 0.3,
        largeImageThreshold: 1200
    },
    html2canvas: {
        allowTaint: false,
        background: '#fff',
        height: null,
        letterRendering: false,
        logging: false,
        proxy: undefined,
        taintTest: true,
        timeout: 0,
        width: null,
        useCORS: false
    }
}

zombiecss.init(defaultOptions)

function comapreUsingZombiecss() {
    zombiecss.screenshot('#element', 'name') //this will save your dom to a file called thing.png in the snapshotLocation

    var results = zombiecss.compareMatch('name') // this will compare the expected with the actual
    results = zombiecss.compare('#left', '#right') // this will look at the dom and work out which is different
    results = zombiecss.compareFiles('leftFile.png', 'rightFile.png') //compare two images, you could probably use your eyes but it is used by this tool

    results.generateReport('./reportLocation.html') //generates a nice report similar to backstop.js

    console.log(results.resenleData) //spits out everything resemble spits out as well
}

zombie
    .visit(url)
    .then(function() {
        zombiecss.zombify(zombie) // you can manipulate your zombie browser before screen shotting
        comapreUsingZombiecss()
    })


//You can call this direct and skip using zombie, above is preferred but not mandatory to use zombiecss
zombiecss
    .visit(url)
    .then(function() {
        comapreUsingZombiecss()
    })

//Like backstop just pass in a config and it will do default behaviour
var zombiecssConfig = defaultOptions

zombiecssConfig.selector = '#element'
zombiecssConfig.name = 'name'
zombiecssConfig.url = url

//these are default things
zombiecssConfig.snapshotLocation = './snapshots'
zombiecssConfig.expectedSnapshotLocation = './snapshots'
zombiecssConfig.diffSnapshotLocation = './snapshots'
zombiecssConfig.actualSnapshotLocation = './snapshots'
zombiecssConfig.expectedSnapshotExtension = '.expected'
zombiecssConfig.diffSnapshotExtension = '.diff'
zombiecssConfig.actualSnapshotExtension = '.actual'
zombiecssConfig.reportLocation = './diff_report.html'

zombiecss.generate(zombiecssConfig)